<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Utilities · MultiComponentFlash.jl</title><meta name="title" content="Utilities · MultiComponentFlash.jl"/><meta property="og:title" content="Utilities · MultiComponentFlash.jl"/><meta property="twitter:title" content="Utilities · MultiComponentFlash.jl"/><meta name="description" content="Documentation for MultiComponentFlash.jl."/><meta property="og:description" content="Documentation for MultiComponentFlash.jl."/><meta property="twitter:description" content="Documentation for MultiComponentFlash.jl."/><meta property="og:url" content="https://moyner.github.io/MultiComponentFlash.jl/api/utilities/"/><meta property="twitter:url" content="https://moyner.github.io/MultiComponentFlash.jl/api/utilities/"/><link rel="canonical" href="https://moyner.github.io/MultiComponentFlash.jl/api/utilities/"/><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../../">MultiComponentFlash.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><span class="tocitem">Examples</span><ul><li><a class="tocitem" href="../../examples/basics/">Basic usage</a></li><li><a class="tocitem" href="../../examples/advanced/">Advanced usage</a></li></ul></li><li><span class="tocitem">API</span><ul><li><a class="tocitem" href="../mixtures/">Mixtures</a></li><li><a class="tocitem" href="../kvalues/">Equilibrium constants</a></li><li><a class="tocitem" href="../eos/">Equations of state</a></li><li><a class="tocitem" href="../flash/">Vapor-liquid equilibrium (Flash)</a></li><li class="is-active"><a class="tocitem" href>Utilities</a><ul class="internal"><li><a class="tocitem" href="#Partial-derivatives"><span>Partial derivatives</span></a></li><li><a class="tocitem" href="#Coupling-utilities"><span>Coupling utilities</span></a></li><li><a class="tocitem" href="#Various"><span>Various</span></a></li></ul></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">API</a></li><li class="is-active"><a href>Utilities</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Utilities</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/moyner/MultiComponentFlash.jl/blob/main/docs/src/api/utilities.md#" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Utilities"><a class="docs-heading-anchor" href="#Utilities">Utilities</a><a id="Utilities-1"></a><a class="docs-heading-anchor-permalink" href="#Utilities" title="Permalink"></a></h1><ul><li><a href="#MultiComponentFlash.inverse_flash_update!-NTuple{4, Any}"><code>MultiComponentFlash.inverse_flash_update!</code></a></li><li><a href="#MultiComponentFlash.lbc_viscosities-Union{Tuple{T}, Tuple{Any, Any, Any, FlashedMixture2Phase{T, A} where A&lt;:AbstractVector{T}}} where T"><code>MultiComponentFlash.lbc_viscosities</code></a></li><li><a href="#MultiComponentFlash.lbc_viscosity-Union{Tuple{T}, Tuple{Any, Any, Any, FlashedPhase{T, A} where A&lt;:AbstractVector{T}}} where T"><code>MultiComponentFlash.lbc_viscosity</code></a></li><li><a href="#MultiComponentFlash.mass_densities-Union{Tuple{T}, Tuple{Any, Any, Any, FlashedMixture2Phase{T, A} where A&lt;:AbstractVector{T}}} where T"><code>MultiComponentFlash.mass_densities</code></a></li><li><a href="#MultiComponentFlash.mass_density-Union{Tuple{V}, Tuple{Any, Any, Any, FlashedPhase{V, A} where A&lt;:AbstractVector{V}}} where V"><code>MultiComponentFlash.mass_density</code></a></li><li><a href="#MultiComponentFlash.molar_volume-Tuple{Any, Any, Any, FlashedPhase}"><code>MultiComponentFlash.molar_volume</code></a></li><li><a href="#MultiComponentFlash.phase_is_present-Tuple{Any, PhaseState2Phase}"><code>MultiComponentFlash.phase_is_present</code></a></li><li><a href="#MultiComponentFlash.phase_saturations-Union{Tuple{T}, Tuple{Any, Any, Any, FlashedMixture2Phase{T, A} where A&lt;:AbstractVector{T}}} where T"><code>MultiComponentFlash.phase_saturations</code></a></li><li><a href="#MultiComponentFlash.set_partials-NTuple{5, Any}"><code>MultiComponentFlash.set_partials</code></a></li><li><a href="#MultiComponentFlash.set_partials_phase_mole_fractions!"><code>MultiComponentFlash.set_partials_phase_mole_fractions!</code></a></li><li><a href="#MultiComponentFlash.set_partials_vapor_fraction-NTuple{4, Any}"><code>MultiComponentFlash.set_partials_vapor_fraction</code></a></li><li><a href="#MultiComponentFlash.single_phase_label-Tuple{MultiComponentMixture, Any}"><code>MultiComponentFlash.single_phase_label</code></a></li></ul><h2 id="Partial-derivatives"><a class="docs-heading-anchor" href="#Partial-derivatives">Partial derivatives</a><a id="Partial-derivatives-1"></a><a class="docs-heading-anchor-permalink" href="#Partial-derivatives" title="Permalink"></a></h2><div class="admonition is-info"><header class="admonition-header">Experimental features</header><div class="admonition-body"><p>Functions for obtaining partial derivatives of the flashed results. Please note that this is an experimental feature. Examples of usage are found in the unit tests.</p></div></div><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MultiComponentFlash.inverse_flash_update!-NTuple{4, Any}" href="#MultiComponentFlash.inverse_flash_update!-NTuple{4, Any}"><code>MultiComponentFlash.inverse_flash_update!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">inverse_flash_update!(storage, eos, c, V)</code></pre><p>Update internal matrix of partial derivatives for a converged flash result.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/moyner/MultiComponentFlash.jl/blob/3de0cb35526bfb48b53a28f525af79fb6dae300a/src/derivatives.jl#L2-L6">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MultiComponentFlash.set_partials-NTuple{5, Any}" href="#MultiComponentFlash.set_partials-NTuple{5, Any}"><code>MultiComponentFlash.set_partials</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">set_partials(v, storage, eos, c, index)</code></pre><p>Modify a value <code>v</code> of ForwardDiff.Dual type to get the correct derivatives.</p><p>If the mixture is two-phase, the partial derivatives of phase molar fractions and vapor fraction with respect to the flash conditions (pressure, temperature and overall mole fractions) are not trivial. This function is the main gateway for setting these values.</p><p><strong>Notes</strong></p><p>Experimental interface, subject to change. You most likely want to use either <a href="#MultiComponentFlash.set_partials_phase_mole_fractions!"><code>set_partials_phase_mole_fractions!</code></a> or <a href="#MultiComponentFlash.set_partials_vapor_fraction-NTuple{4, Any}"><code>set_partials_vapor_fraction</code></a></p><p>In order for this routine to work, the storage must be initialized using <code>flash_storage</code> with the following options enabled:</p><ul><li><code>inc_jac = true</code></li><li><code>diff_externals = true</code></li></ul><p>and <code>inverse_flash_update!</code> must be called after a successful flash. The partial derivatives with respect to p, T, z is then contained in <code>storage.buf_inv</code> with a negative sign. This function then performs the requisite chain rule operations for the input.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/moyner/MultiComponentFlash.jl/blob/3de0cb35526bfb48b53a28f525af79fb6dae300a/src/derivatives.jl#L26-L46">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MultiComponentFlash.set_partials_phase_mole_fractions!" href="#MultiComponentFlash.set_partials_phase_mole_fractions!"><code>MultiComponentFlash.set_partials_phase_mole_fractions!</code></a> — <span class="docstring-category">Function</span></header><section><div><p>set<em>partials</em>phase<em>mole</em>fractions!(xy, storage, eos, ∂c, [phase_symbol])</p><p>Set partial derivatives to phase mole fraction vector with type <code>ForwardDiff.Dual</code> with correct values, but missing partial derivatives.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/moyner/MultiComponentFlash.jl/blob/3de0cb35526bfb48b53a28f525af79fb6dae300a/src/derivatives.jl#L99-L104">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MultiComponentFlash.set_partials_vapor_fraction-NTuple{4, Any}" href="#MultiComponentFlash.set_partials_vapor_fraction-NTuple{4, Any}"><code>MultiComponentFlash.set_partials_vapor_fraction</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">set_partials_vapor_fraction(V, storage, eos, ∂c)</code></pre><p>Set partial derivatives to a vapor mole fraction <code>ForwardDiff.Dual</code> instance with correct value, but missing partial derivatives.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/moyner/MultiComponentFlash.jl/blob/3de0cb35526bfb48b53a28f525af79fb6dae300a/src/derivatives.jl#L91-L96">source</a></section></article><h2 id="Coupling-utilities"><a class="docs-heading-anchor" href="#Coupling-utilities">Coupling utilities</a><a id="Coupling-utilities-1"></a><a class="docs-heading-anchor-permalink" href="#Coupling-utilities" title="Permalink"></a></h2><div class="admonition is-info"><header class="admonition-header">Experimental features</header><div class="admonition-body"><p>Utilities for coupling flash to simulation codes. Please note that this is an experimental feature.</p></div></div><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MultiComponentFlash.lbc_viscosities-Union{Tuple{T}, Tuple{Any, Any, Any, FlashedMixture2Phase{T, A} where A&lt;:AbstractVector{T}}} where T" href="#MultiComponentFlash.lbc_viscosities-Union{Tuple{T}, Tuple{Any, Any, Any, FlashedMixture2Phase{T, A} where A&lt;:AbstractVector{T}}} where T"><code>MultiComponentFlash.lbc_viscosities</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">lbc_viscosities(eos, p, T, flashed_mixture)</code></pre><p>Compute phase viscosities for a flashed two-phase mixture using the LBC correlation.</p><p>Always returns a named tuple of (μ<em>l, μ</em>v), even if the mixture is single-phase.</p><p>The value in the absent phase will be a tiny value (eps of the numeric type) to make division for mobilities etc. safe.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/moyner/MultiComponentFlash.jl/blob/3de0cb35526bfb48b53a28f525af79fb6dae300a/src/flow_coupler.jl#L158-L167">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MultiComponentFlash.mass_densities-Union{Tuple{T}, Tuple{Any, Any, Any, FlashedMixture2Phase{T, A} where A&lt;:AbstractVector{T}}} where T" href="#MultiComponentFlash.mass_densities-Union{Tuple{T}, Tuple{Any, Any, Any, FlashedMixture2Phase{T, A} where A&lt;:AbstractVector{T}}} where T"><code>MultiComponentFlash.mass_densities</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">mass_densities(eos, p, T, flashed_mixture)</code></pre><p>Compute mass densities for a flashed two-phase mixture.</p><p>Always returns a named tuple of (ρ<em>l, ρ</em>v), even if the mixture is single-phase.</p><p>The value in the absent phase will be zero.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/moyner/MultiComponentFlash.jl/blob/3de0cb35526bfb48b53a28f525af79fb6dae300a/src/flow_coupler.jl#L133-L141">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MultiComponentFlash.mass_density-Union{Tuple{V}, Tuple{Any, Any, Any, FlashedPhase{V, A} where A&lt;:AbstractVector{V}}} where V" href="#MultiComponentFlash.mass_density-Union{Tuple{V}, Tuple{Any, Any, Any, FlashedPhase{V, A} where A&lt;:AbstractVector{V}}} where V"><code>MultiComponentFlash.mass_density</code></a> — <span class="docstring-category">Method</span></header><section><div><p>Compute mass density of a flashed phase</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/moyner/MultiComponentFlash.jl/blob/3de0cb35526bfb48b53a28f525af79fb6dae300a/src/flow_coupler.jl#L121">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MultiComponentFlash.molar_volume-Tuple{Any, Any, Any, FlashedPhase}" href="#MultiComponentFlash.molar_volume-Tuple{Any, Any, Any, FlashedPhase}"><code>MultiComponentFlash.molar_volume</code></a> — <span class="docstring-category">Method</span></header><section><div><p>Compute molar volume of a flashed phase</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/moyner/MultiComponentFlash.jl/blob/3de0cb35526bfb48b53a28f525af79fb6dae300a/src/flow_coupler.jl#L97">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MultiComponentFlash.phase_is_present-Tuple{Any, PhaseState2Phase}" href="#MultiComponentFlash.phase_is_present-Tuple{Any, PhaseState2Phase}"><code>MultiComponentFlash.phase_is_present</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">phase_is_present(label, phase_state)</code></pre><p>Check if a phase (symbol :liquid/:vapor) is present with the provided phase state.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/moyner/MultiComponentFlash.jl/blob/3de0cb35526bfb48b53a28f525af79fb6dae300a/src/flow_coupler.jl#L5-L9">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MultiComponentFlash.phase_saturations-Union{Tuple{T}, Tuple{Any, Any, Any, FlashedMixture2Phase{T, A} where A&lt;:AbstractVector{T}}} where T" href="#MultiComponentFlash.phase_saturations-Union{Tuple{T}, Tuple{Any, Any, Any, FlashedMixture2Phase{T, A} where A&lt;:AbstractVector{T}}} where T"><code>MultiComponentFlash.phase_saturations</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">phase_saturations(eos, p, T, flashed_mixture)</code></pre><p>Compute phase saturations for a flashed two-phase mixture.</p><p>Always returns a named tuple of (S<em>l, S</em>v), even if the mixture is single-phase.</p><p>The value in the absent phase will be zero.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/moyner/MultiComponentFlash.jl/blob/3de0cb35526bfb48b53a28f525af79fb6dae300a/src/flow_coupler.jl#L60-L68">source</a></section></article><h2 id="Various"><a class="docs-heading-anchor" href="#Various">Various</a><a id="Various-1"></a><a class="docs-heading-anchor-permalink" href="#Various" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MultiComponentFlash.lbc_viscosity-Union{Tuple{T}, Tuple{Any, Any, Any, FlashedPhase{T, A} where A&lt;:AbstractVector{T}}} where T" href="#MultiComponentFlash.lbc_viscosity-Union{Tuple{T}, Tuple{Any, Any, Any, FlashedPhase{T, A} where A&lt;:AbstractVector{T}}} where T"><code>MultiComponentFlash.lbc_viscosity</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">lbc_viscosity(eos, p, T, ph; &lt;keyword arguments&gt;)</code></pre><p>Compute the viscosity of a mixture using the <a href="https://doi.org/10.2118/915-PA">Lohrenz-Bray-Clark</a> correlation.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/moyner/MultiComponentFlash.jl/blob/3de0cb35526bfb48b53a28f525af79fb6dae300a/src/utils.jl#L29-L33">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MultiComponentFlash.single_phase_label-Tuple{MultiComponentMixture, Any}" href="#MultiComponentFlash.single_phase_label-Tuple{MultiComponentMixture, Any}"><code>MultiComponentFlash.single_phase_label</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">single_phase_label(mixture, cond)</code></pre><p>Li&#39;s method for single-phase labeling of a mixture. Estimate of pure vapor/liquid.</p><p>Returns a vapor fraction that is either 1.0 (=pure vapor) or 0.0 (=pure liquid).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/moyner/MultiComponentFlash.jl/blob/3de0cb35526bfb48b53a28f525af79fb6dae300a/src/utils.jl#L6-L12">source</a></section></article></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../flash/">« Vapor-liquid equilibrium (Flash)</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="auto">Automatic (OS)</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.2.1 on <span class="colophon-date" title="Sunday 28 January 2024 16:53">Sunday 28 January 2024</span>. Using Julia version 1.10.0.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
